<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:122,&quot;tests&quot;:103,&quot;passes&quot;:103,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2020-02-01T15:31:22.526Z&quot;,&quot;end&quot;:&quot;2020-02-01T15:31:44.114Z&quot;,&quot;duration&quot;:21588,&quot;testsRegistered&quot;:103,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;43e59192-3992-4e0b-8567-6b3bb2e87e82&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;17050998-6ee8-498a-86ea-bebdd7df4c41&quot;,&quot;title&quot;:&quot;main-api&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6b8f4ec9-7001-44dd-ae8f-7257e238b1c8&quot;,&quot;title&quot;:&quot;GET /api/checkAgent&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;main-api GET /api/checkAgent should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:18,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/api/checkAgent&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\t\t\t\tassert.strictEqual(res.body.status, 0);\n\t\t\t\tassert.strictEqual(typeof res.body.version, &#x27;string&#x27;);\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c3a42baa-cd20-4fdb-ab81-8548598cddc1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c3a42baa-cd20-4fdb-ab81-8548598cddc1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:18,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;734a8ab9-c1c1-4736-87f2-7cc9dc53374a&quot;,&quot;title&quot;:&quot;GET /api/checkPort&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;main-api GET /api/checkPort should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/api/checkPort?port=&#x27;+PORT+&#x27;&amp;host=&#x27;+HOST) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\t\t\t\tassert.strictEqual(res.body.result, true);\n\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8c92336a-f850-403b-90e0-eaac8044e509&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8c92336a-f850-403b-90e0-eaac8044e509&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;64cd0501-0b70-4b77-8874-90f266cdd24a&quot;,&quot;title&quot;:&quot;GET /api/admin/os/cpus&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;main-api GET /api/admin/os/cpus should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/api/admin/os/cpus&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual(_.isArray(res.body), true, &#x27;body is array&#x27;)\t\t\n\t\t\t\tassert.strictEqual(res.body.length &gt; 0, true, &#x27;result is empty&#x27;)\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a2670847-2698-46cf-8ebb-46269d315e1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a2670847-2698-46cf-8ebb-46269d315e1e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2ff3a7d8-6ece-4a50-839a-e7b5e37db91e&quot;,&quot;title&quot;:&quot;POST /api/getConfig&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;main-api POST /api/getConfig should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;POST&#x27;, &#x27;/api/getConfig&#x27;) )\n.then( (res) =&gt; {\t\t\n\texpect(res.statusCode).to.equal(200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.data, &#x27;string&#x27;);\n\tconfData = res.body.data\n\tdone()\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c0a86c57-5a5f-41c8-832f-29670595f0d4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c0a86c57-5a5f-41c8-832f-29670595f0d4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a52cb9ff-c265-40d3-a33f-e9788f1762d3&quot;,&quot;title&quot;:&quot;POST /api/setConfig without data&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;main-api POST /api/setConfig without data should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let updateOpt = getHttpOptions(&#x27;POST&#x27;, &#x27;/api/setConfig&#x27;)\t\t\t\t\nupdateOpt.body = {}\nexecRequestExpectError(updateOpt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8b4f8368-8d87-4b73-a33b-c1cf44237725&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8b4f8368-8d87-4b73-a33b-c1cf44237725&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6c80cf88-23c1-49ee-a708-53edb9869357&quot;,&quot;title&quot;:&quot;POST /api/setConfig without data.getConfig()&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;main-api POST /api/setConfig without data.getConfig() should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let updateOpt = getHttpOptions(&#x27;POST&#x27;, &#x27;/api/setConfig&#x27;)\t\t\t\t\nupdateOpt.body = {\n\tdata: &#x27;{}&#x27;\n}\n\nexecRequestExpectError(updateOpt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9988cff3-e422-4217-bd72-87a171367606&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9988cff3-e422-4217-bd72-87a171367606&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7c6cd2db-944b-42c5-92e3-543353241056&quot;,&quot;title&quot;:&quot;POST /api/setConfig&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\10-main-api.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;main-api POST /api/setConfig should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let updateOpt = getHttpOptions(&#x27;POST&#x27;, &#x27;/api/setConfig&#x27;)\t\t\t\t\nupdateOpt.body = {\n\tdata: confData\n}\n\nrequest( updateOpt )\n.then( (res) =&gt; {\t\n\t\n\texpect(res.statusCode).to.equal(200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.data, &#x27;string&#x27;);\n\tdone()\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ca46ecce-de97-4887-be75-ba47f7f92223&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ca46ecce-de97-4887-be75-ba47f7f92223&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e9b8e2bd-187f-4870-81b2-cd7d153df34c&quot;,&quot;title&quot;:&quot;plugin-dns&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-dns.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-dns.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;5685bcb8-f610-4bd0-a3e5-629b786e85f1&quot;,&quot;title&quot;:&quot;GET /_plugin/dns/dnsReverse&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-dns.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-dns.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;plugin-dns GET /_plugin/dns/dnsReverse should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/dns/dnsReverse?ip=1.1.1.1&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tconsole.log(res.body)\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual(res.body.ip, &#x27;1.1.1.1&#x27;)\t\t\t\t\t\n\t\t\t\tassert.strictEqual(_.isArray(res.body.hostnames), true, &#x27;hostnames is not array&#x27;)\t\t\t\t\t\t\n\t\t\t\tassert.deepEqual(res.body.hostnames, [&#x27;one.one.one.one&#x27;] )\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f907ec12-44fb-4948-98ad-ee7cc22058d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f907ec12-44fb-4948-98ad-ee7cc22058d1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;40193d2a-8d40-4f0e-b80d-8f9e3f8e7d92&quot;,&quot;title&quot;:&quot;GET /_plugin/dns/dnsReverse&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-dns.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-dns.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;plugin-dns GET /_plugin/dns/dnsReverse should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/dns/dnsReverse?ip=1.1.1.1&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tconsole.log(res.body)\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual(res.body.ip, &#x27;1.1.1.1&#x27;)\t\t\t\t\t\n\t\t\t\tassert.strictEqual(_.isArray(res.body.hostnames), true, &#x27;hostnames is not array&#x27;)\t\t\t\t\t\t\n\t\t\t\tassert.deepEqual(res.body.hostnames, [&#x27;one.one.one.one&#x27;] )\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;05134704-a3ff-4ab8-a3b3-20bfcf527fba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;05134704-a3ff-4ab8-a3b3-20bfcf527fba&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b5801476-9376-4bcd-887f-cc4eb86249ef&quot;,&quot;title&quot;:&quot;GET /_plugin/dns/dnsReverse (no result)&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-dns.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-dns.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;plugin-dns GET /_plugin/dns/dnsReverse (no result) should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/dns/dnsReverse?ip=0.0.0.0&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tconsole.log(res.body)\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual(res.body.ip, &#x27;0.0.0.0&#x27;)\t\t\t\t\t\n\t\t\t\tassert.strictEqual(_.isArray(res.body.hostnames), true, &#x27;hostnames is not array&#x27;)\t\t\t\t\t\t\n\t\t\t\tassert.deepEqual(res.body.hostnames, [] )\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0e4e0a85-69db-4c9e-9eb8-d8abac00ff0f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0e4e0a85-69db-4c9e-9eb8-d8abac00ff0f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4fc359cf-dd06-4a38-aae9-79bdea446574&quot;,&quot;title&quot;:&quot;GET /_plugin/filesystem&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 404&quot;,&quot;fullTitle&quot;:&quot;GET /_plugin/filesystem should return 404&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem&#x27;)\nexecRequestExpectError(opt, done, 404)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0dbb9398-3fbd-4d23-9c67-cf683acdb9c6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0dbb9398-3fbd-4d23-9c67-cf683acdb9c6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;56a8566b-7c4a-4f66-9759-cb406c3718ec&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/moveFile&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;42d69fb3-d4de-4790-89fa-128448d176f8&quot;,&quot;title&quot;:&quot;POST /moveFile no path&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile no path should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let dest = tmpDir\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\nopt.body = {\n\tdest: dest\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;df61a2a8-13aa-4234-9759-dcccc3a4887a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;df61a2a8-13aa-4234-9759-dcccc3a4887a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;503be096-722a-44be-8ad0-a87a5fa5d34d&quot;,&quot;title&quot;:&quot;POST /moveFile no dest&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile no dest should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir+&#x27;/testmove1.txt&#x27;\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\nopt.body = {\n\tpath: path\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;81327140-1b18-472d-b79e-60436d1056fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;81327140-1b18-472d-b79e-60436d1056fa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b7b5c361-3d03-469c-8596-00f27a960d2c&quot;,&quot;title&quot;:&quot;POST /moveFile to directory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400 - dest is directory&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile to directory should return 400 - dest is directory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = tmpDir+&#x27;/test-move1.txt&#x27;\nlet dest = tmpDir\nfs.writeFileSync(source, &#x27;test&#x27;)\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2557e398-aa5c-4f5a-9ad1-70599f1ba1f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2557e398-aa5c-4f5a-9ad1-70599f1ba1f6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d61fe2b4-a9db-4121-9c17-0202f120ddd1&quot;,&quot;title&quot;:&quot;POST /moveFile dest directory does not exists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile dest directory does not exists should return error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = tmpDir+&#x27;/test-move1.txt&#x27;\nlet dest = tmpDir+&#x27;/blablabla/index.txt&#x27;\nif (fs.pathExistsSync(tmpDir+&#x27;/blablabla&#x27;))\n\tfs.unlinkSync(tmpDir+&#x27;/blablabla&#x27;)\n\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fdcc4446-df4a-4a60-9c52-c26c33830358&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fdcc4446-df4a-4a60-9c52-c26c33830358&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b03ab335-d195-482b-a5c2-225f48c07376&quot;,&quot;title&quot;:&quot;POST /moveFile path=\\\\localhost\\d$\\tmp/test.txt&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile path=\\\\localhost\\d$\\tmp/test.txt should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = tmpDir+&#x27;/test.txt&#x27;\nlet dest = tmpDir+&#x27;/testMoved.txt&#x27;\nfs.writeFileSync(source, &#x27;test&#x27;)\nif (fs.pathExistsSync(dest))\n\tfs.unlinkSync(dest)\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.result, true);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e91e0224-1b7a-4cd4-b4ec-df261939579d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e91e0224-1b7a-4cd4-b4ec-df261939579d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1d84d494-7bd4-4e22-adf9-3fb1bafc8d5c&quot;,&quot;title&quot;:&quot;POST /moveFile - dest already exists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile - dest already exists should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = tmpDir+&#x27;/test.txt&#x27;\nlet dest = tmpDir+&#x27;/testMoved.txt&#x27;\nfs.writeFileSync(source, &#x27;test&#x27;)\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;02b37f30-1828-4f57-a8a6-dda11d38f750&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;02b37f30-1828-4f57-a8a6-dda11d38f750&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ae91e31e-3b41-4dc7-adcf-d8da297d170f&quot;,&quot;title&quot;:&quot;POST /moveFile - dest already exists - overwrite=true&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile - dest already exists - overwrite=true should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = tmpDir+&#x27;/test.txt&#x27;\nlet dest = tmpDir+&#x27;/testMoved.txt&#x27;\nfs.writeFileSync(source, &#x27;test&#x27;)\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest,\n\toverwrite: true\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.result, true);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a9b179f6-d6ee-4927-a503-951279e1521d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a9b179f6-d6ee-4927-a503-951279e1521d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d7419563-424a-415f-bdac-edc3d07f973a&quot;,&quot;title&quot;:&quot;POST /moveFile source is directory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200 - source is directory dest does not exists&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile source is directory should return 200 - source is directory dest does not exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = tmpDir+&#x27;/directoryToMove&#x27;\nfs.ensureDirSync(source)\nfs.writeFileSync(source+\&quot;/test.txt\&quot;, &#x27;test&#x27;)\nlet dest = tmpDir+&#x27;/destDirectory1&#x27;\nif (fs.pathExistsSync(dest))\n\tfs.removeSync(dest)\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.result, true);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;31785d9e-e871-401d-9069-53fd115f0b8e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;31785d9e-e871-401d-9069-53fd115f0b8e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ceaaa1a2-5e2e-486d-b517-23a63ed00e27&quot;,&quot;title&quot;:&quot;POST /moveFile - source is directory - destination exists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/moveFile POST /moveFile - source is directory - destination exists should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = tmpDir+&#x27;/directoryToMove2&#x27;\n\t\t\tfs.ensureDirSync(source)\n\t\t\tfs.writeFileSync(source+\&quot;/test.txt\&quot;, &#x27;test&#x27;)\n\t\t\tlet dest = tmpDir+&#x27;/destDirectory2&#x27;\n\t\t\tfs.ensureDirSync(dest)\n\t\t\tlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/moveFile&#x27;)\n\t\t\topt.body = {\n\t\t\t\tpath: source,\n\t\t\t\tdest: dest\n\t\t\t}\n\t\t\texecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;29e71119-ce5e-495e-9c61-bd28652729c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;29e71119-ce5e-495e-9c61-bd28652729c9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;24cb1269-78ae-4d2e-b7a5-f3996647667b&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/copyFile&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;76b64f32-1213-4c12-aa1a-c187a8598c07&quot;,&quot;title&quot;:&quot;POST /copyFile dest is directory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/copyFile POST /copyFile dest is directory should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = sourceFile\nlet dest = tmpDir\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/copyFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f9e3c332-f36f-4459-a3d6-9a9a3e19694a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f9e3c332-f36f-4459-a3d6-9a9a3e19694a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c57248af-87f7-4438-bd2c-8bffddd07fa5&quot;,&quot;title&quot;:&quot;POST /copyFile dest already exists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/copyFile POST /copyFile dest already exists should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = sourceFile\nlet dest = tmpDir+&#x27;/index.txt&#x27;\nif (!fs.pathExistsSync(dest))\n\tfs.writeFileSync(dest, &#x27;test&#x27;)\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/copyFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\t\t\t\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0c97901c-28bf-4480-a087-337f5069505a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0c97901c-28bf-4480-a087-337f5069505a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7e20c2f3-12a6-4165-b389-3ca5e69125db&quot;,&quot;title&quot;:&quot;POST /copyFile path does not exists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/copyFile POST /copyFile path does not exists should return error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = sourceDir+&#x27;/blablabla&#x27;\nlet dest = tmpDir+&#x27;/blablabla&#x27;\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/copyFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d2c2ed19-d593-4eba-ba05-054b2195e354&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d2c2ed19-d593-4eba-ba05-054b2195e354&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d7d99f9d-1f09-44eb-8230-ac48a33d1246&quot;,&quot;title&quot;:&quot;POST /copyFile dest directory does not exists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/copyFile POST /copyFile dest directory does not exists should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = sourceFile\nlet dest = tmpDir+&#x27;/blablabla/index.txt&#x27;\nif (fs.pathExistsSync(tmpDir+&#x27;/blablabla&#x27;))\n\tfs.removeSync(tmpDir+&#x27;/blablabla&#x27;)\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/copyFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3228741b-b198-43f7-a747-78633af320a9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3228741b-b198-43f7-a747-78633af320a9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9a3b5624-f405-4642-af05-87663a8f22da&quot;,&quot;title&quot;:&quot;POST /copyFile path=D:\\projets\\mr-agent\\test\\worker/../../dist/index.js&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/copyFile POST /copyFile path=D:\\projets\\mr-agent\\test\\worker/../../dist/index.js should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = sourceFile\nlet dest = tmpDir+&#x27;/index.txt&#x27;\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/copyFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.result, true);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5084657a-8688-4807-b782-777651a7f998&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5084657a-8688-4807-b782-777651a7f998&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;5e98b7ef-45bb-4f5f-bb32-d77436ce520c&quot;,&quot;title&quot;:&quot;POST /copyFile source is directory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error - source is directory&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/copyFile POST /copyFile source is directory should return error - source is directory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let source = tmpDir\nlet dest = tmpDir+&#x27;/testMoved.txt&#x27;\n\t\t\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/copyFile&#x27;)\nopt.body = {\n\tpath: source,\n\tdest: dest\n}\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7d26a37e-424c-4b35-9a5f-86988b687b1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7d26a37e-424c-4b35-9a5f-86988b687b1e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f8c2011c-28a4-4bbf-894b-a80f6daa4469&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/fileinfo&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;5dfa6d24-5611-4ed7-a240-4074caad8fe3&quot;,&quot;title&quot;:&quot;GET /fileinfo path=D:\\projets\\mr-agent\\test\\worker/../../dist/index.js&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/fileinfo GET /fileinfo path=D:\\projets\\mr-agent\\test\\worker/../../dist/index.js should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/fileinfo?path=&#x27;+sourceFile)\n\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.name, &#x27;index.js&#x27;);\n\tassert.strictEqual(res.body.contentType.contains(&#x27;application/javascript&#x27;), true);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9aa9e5c5-954a-4602-a1ef-e13a135ca0c4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9aa9e5c5-954a-4602-a1ef-e13a135ca0c4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;5e11d4ea-7566-4324-8edf-b6cd624866eb&quot;,&quot;title&quot;:&quot;GET /fileinfo path=blablabla&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/fileinfo GET /fileinfo path=blablabla should return error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/fileinfo?path=blablabla&#x27;)\n\nexecRequestExpectError(opt, done, 500)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d9fb6388-8c1d-4413-bf33-409c068e8b49&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d9fb6388-8c1d-4413-bf33-409c068e8b49&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a7213c9c-64e7-4b02-ba59-952fe5070571&quot;,&quot;title&quot;:&quot;GET /fileinfo&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/fileinfo GET /fileinfo should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/fileinfo&#x27;)\n\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b67daa38-1bda-4e08-80b6-4c905fdb5c9d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b67daa38-1bda-4e08-80b6-4c905fdb5c9d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8d945f08-cf58-460f-8803-ec5d91ed4e9b&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/fileExists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;deaf8bcc-a7ee-46d6-b91d-5cbf785db12e&quot;,&quot;title&quot;:&quot;GET /fileExists path=D:\\projets\\mr-agent\\test\\worker/../../dist/index.js&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/fileExists GET /fileExists path=D:\\projets\\mr-agent\\test\\worker/../../dist/index.js should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/fileExists?path=&#x27;+sourceFile)\n\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.result, true);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0f1478d0-9073-4b39-9aa8-af8588ec54f1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0f1478d0-9073-4b39-9aa8-af8588ec54f1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;90e0a632-6896-4cd1-852b-2b5a6dde5012&quot;,&quot;title&quot;:&quot;GET /fileExists path=blablabla&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/fileExists GET /fileExists path=blablabla should return error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/fileExists?path=blablabla&#x27;)\n\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.result, false);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d4616257-fa2a-44b2-ae30-c009d046fb03&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d4616257-fa2a-44b2-ae30-c009d046fb03&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0da394b4-ac00-4a00-84c8-3a4e13037753&quot;,&quot;title&quot;:&quot;GET /fileExists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/fileExists GET /fileExists should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/fileExists&#x27;)\n\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8ff39830-2f8a-4bb3-8f7c-e87371afabc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8ff39830-2f8a-4bb3-8f7c-e87371afabc3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;88957cd7-e80a-4f84-9e09-f76182cbc5f6&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/execScript&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;68b5584d-0e39-4724-9232-cb2181666dd3&quot;,&quot;title&quot;:&quot;POST execScript type=shell&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/execScript POST execScript type=shell should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/execScript&#x27;)\nopt.body = {\n\tscript: \&quot;dir\&quot;\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.exitCode, 0);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ec5d077a-1681-445b-aa02-5ac694328f0f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ec5d077a-1681-445b-aa02-5ac694328f0f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:24,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e076a15a-542f-4fce-b7bf-49958abe6d5c&quot;,&quot;title&quot;:&quot;POST execScript type=blabla&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/execScript POST execScript type=blabla should return error 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/execScript&#x27;)\nopt.body = {\n\tscript: \&quot;dir\&quot;,\n\ttype: &#x27;blabla&#x27;\n}\nexecRequestExpectError(opt, done, 412)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;20bd5217-b205-4c50-bf22-dc9734bf2445&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;20bd5217-b205-4c50-bf22-dc9734bf2445&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7dc3a1f9-def0-4509-a909-b2fbb8193db7&quot;,&quot;title&quot;:&quot;POST execScript type=javascript with result&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/execScript POST execScript type=javascript with result should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/execScript&#x27;)\nopt.body = {\n\tscript: \&quot;result = 2*2\&quot;,\n\ttype: &#x27;javascript&#x27;\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.stdout, 4);\n\tassert.strictEqual(res.body.exitCode, 0);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7dac37a3-4431-4422-8776-a0bd52ed9d32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7dac37a3-4431-4422-8776-a0bd52ed9d32&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;89eaca55-710d-4ef1-9b34-bf19f8062634&quot;,&quot;title&quot;:&quot;POST execScript type=javascript with result &amp;&amp; exitCode&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/execScript POST execScript type=javascript with result &amp;&amp; exitCode should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/execScript&#x27;)\nopt.body = {\n\tscript: \&quot;result = 2*2\\nexitCode=2\&quot;,\n\ttype: &#x27;javascript&#x27;\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.stdout, 4);\n\tassert.strictEqual(res.body.exitCode, 2);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c992e594-2eae-4e3b-b2af-6f966fe93179&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c992e594-2eae-4e3b-b2af-6f966fe93179&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4e9fe955-d8a1-4119-9ccf-bb828dcf69cd&quot;,&quot;title&quot;:&quot;POST execScript type=javascript with syntax error&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 500&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/execScript POST execScript type=javascript with syntax error should return 500&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/execScript&#x27;)\nopt.body = {\n\tscript: \&quot;blabla\&quot;,\n\ttype: &#x27;javascript&#x27;\n}\nexecRequestExpectError(opt, done, 500)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;88d54159-3a63-4061-a770-6aba8346a3df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;88d54159-3a63-4061-a770-6aba8346a3df&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4fa2b7e6-a362-42f5-b154-593aaaa0eead&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/writeTextFile&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ce61c4aa-7d09-4ce8-8c2c-3da890010609&quot;,&quot;title&quot;:&quot;POST /_plugin/filesystem/writeTextFile&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/writeTextFile POST /_plugin/filesystem/writeTextFile should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/writeTextFile&#x27;)\n\t\t\topt.body = {\npath: tmpDir+\&quot;/writeTextFile.txt\&quot;,\ncontent: &#x27;test&#x27;\n\t\t\t}\n\n\t\t\trequest( opt )\n\t\t\t.then( (res) =&gt; {\t\n\t\t\nassert.strictEqual(res.statusCode, 200);\nassert.strictEqual(typeof res.body, &#x27;object&#x27;);\nassert.strictEqual(typeof res.body.path, &#x27;string&#x27;);\nassert.strictEqual(res.body.result, true);\ndone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\ndone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c454005b-a2c4-4c7f-ae1b-a30f7d3a5217&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c454005b-a2c4-4c7f-ae1b-a30f7d3a5217&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;108373e9-a8f9-4f32-978a-cc954c1f25b6&quot;,&quot;title&quot;:&quot;POST writeTextFile, path does not exist&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 500&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/writeTextFile POST writeTextFile, path does not exist should return 500&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/writeTextFile&#x27;)\n\t\t\topt.body = {\npath: tmpDir+\&quot;/blabla/writeTextFile.txt\&quot;,\ncontent: &#x27;test&#x27;\n\t\t\t}\n\n\t\t\texecRequestExpectError(opt, done, 500)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c8655680-6e14-49fc-bb93-794b11f6da6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c8655680-6e14-49fc-bb93-794b11f6da6a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;09923207-ba20-4138-b06d-e1ee636978b9&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/list&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e259d703-c99a-4e84-a095-cb85d1beeb95&quot;,&quot;title&quot;:&quot;GET path=D:\\projets\\mr-agent\\test\\worker/../../dist&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return file list&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/list GET path=D:\\projets\\mr-agent\\test\\worker/../../dist should return file list&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;var query = &#x27;path=&#x27;+sourceDir\nrequest( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/list?&#x27;+query) )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.files, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.files.push, &#x27;function&#x27;);\n\tassert.strictEqual(res.body.total, 26);\n\tassert.strictEqual(res.body.files.length, 26);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;13a69ccb-6815-4c71-9437-817304bbaa31&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;13a69ccb-6815-4c71-9437-817304bbaa31&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7192de3c-aa40-4146-9e90-c0e16ab8ced7&quot;,&quot;title&quot;:&quot;GET recursive=false&amp;filter=*.map&amp;path=D:\\projets\\mr-agent\\test\\worker/../../dist&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 5 .map files&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/list GET recursive=false&amp;filter=*.map&amp;path=D:\\projets\\mr-agent\\test\\worker/../../dist should return 5 .map files&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;var query = &#x27;recursive=false&amp;filter=*.map&amp;path=&#x27;+sourceDir\nrequest( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/list?&#x27;+query) )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.files, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.files.push, &#x27;function&#x27;);\n\tassert.strictEqual(res.body.total, 7);\n\tassert.strictEqual(res.body.files.length, 7);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7880216e-d596-4595-ad11-44babfa50dd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7880216e-d596-4595-ad11-44babfa50dd7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1245f570-bcd5-434e-872f-2ead5c119bba&quot;,&quot;title&quot;:&quot;GET recursive=true&amp;path=D:\\projets\\mr-agent\\test\\worker/../../dist&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return file list&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/list GET recursive=true&amp;path=D:\\projets\\mr-agent\\test\\worker/../../dist should return file list&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:31,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;var query = &#x27;recursive=true&amp;path=&#x27;+sourceDir\nrequest( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/list?&#x27;+query) )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.files, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.files.push, &#x27;function&#x27;);\n\tassert.strictEqual(res.body.total, 247);\n\tassert.strictEqual(res.body.files.length, 247);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6d515038-e560-479b-ac04-af906b8eb585&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6d515038-e560-479b-ac04-af906b8eb585&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:31,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a346ec8d-734e-4d57-a12b-596e9e0d947a&quot;,&quot;title&quot;:&quot;GET recursive=true&amp;filter=*.js&amp;path=D:\\projets\\mr-agent\\test\\worker/../../dist&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return file list&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/list GET recursive=true&amp;filter=*.js&amp;path=D:\\projets\\mr-agent\\test\\worker/../../dist should return file list&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:31,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;var query = &#x27;recursive=true&amp;filter=*.js&amp;path=&#x27;+sourceDir\nrequest( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/list?&#x27;+query) )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.files, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.files.push, &#x27;function&#x27;);\n\tassert.strictEqual(res.body.total, 74);\n\tassert.strictEqual(res.body.files.length, 74);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;398f1bca-3b59-4cef-b52a-9c278a3e29b0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;398f1bca-3b59-4cef-b52a-9c278a3e29b0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:31,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6dcb26a9-2125-40e4-964c-ff7cc82463bb&quot;,&quot;title&quot;:&quot;GET recursive=true&amp;maxResults=10&amp;filter=*.ts&amp;path=D:\\projets\\mr-agent\\test\\worker/../../dist&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return file list&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/list GET recursive=true&amp;maxResults=10&amp;filter=*.ts&amp;path=D:\\projets\\mr-agent\\test\\worker/../../dist should return file list&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;var query = &#x27;recursive=true&amp;maxResults=10&amp;filter=*.ts&amp;path=&#x27;+sourceDir\n\trequest( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/list?&#x27;+query) )\n\t.then( (res) =&gt; {\t\n\t\tassert.strictEqual(res.statusCode, 200);\n\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\t\tassert.strictEqual(typeof res.body.files, &#x27;object&#x27;);\n\t\tassert.strictEqual(typeof res.body.files.push, &#x27;function&#x27;);\n\t\tassert.strictEqual(res.body.total, 74);\n\t\tassert.strictEqual(res.body.files.length, 10);\n\t\tdone();\t\t\t\t\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a86bcb30-6d64-475d-9979-c5419b00c648&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a86bcb30-6d64-475d-9979-c5419b00c648&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:22,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1ced219b-4e0e-429d-8245-f05baa9aff16&quot;,&quot;title&quot;:&quot;GET recursive=true&amp;path=/blablabla&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/list GET recursive=true&amp;path=/blablabla should return error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;var query = &#x27;recursive=true&amp;path=/blablabla&#x27;\nlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/list?&#x27;+query)\nexecRequestExpectError(opt, done, 500)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;eb7115a6-971e-403b-9e52-ae6ee7e40369&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;eb7115a6-971e-403b-9e52-ae6ee7e40369&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;5ae1f9ea-e1c4-4415-b71b-f648637c582e&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/upload&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;fb5ab8fc-b64e-468c-a8fd-62457a635f45&quot;,&quot;title&quot;:&quot;upload file&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/upload upload file should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:663,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir+&#x27;/upload.txt&#x27;\n\tif (fs.pathExistsSync(path))\n\t\tfs.unlinkSync(path)\n\tlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/upload?path=&#x27;+path)\n\t\n\topt.formData = {\n        // Like &lt;input type=\&quot;text\&quot; name=\&quot;name\&quot;&gt;\n        name: sourceFileName,\n        // Like &lt;input type=\&quot;file\&quot; name=\&quot;file\&quot;&gt;\n        file1: {\n            value: fs.createReadStream(sourceFile),\n            options: {\n                filename: sourceFileName,\n                contentType: &#x27;application/javascript&#x27;\n            }\n        },\n        file2: {\n            value: fs.createReadStream(sourceDir+&#x27;/Application.js&#x27;),\n            options: {\n                filename: &#x27;Application.js&#x27;,\n                contentType: &#x27;application/javascript&#x27;\n            }\n        }\n    },\n\t\t\t\n\trequest( opt )\n\t.then( (res) =&gt; {\t\n\t\t//console.log( res.body)\n\t\tassert.strictEqual(res.statusCode, 200);\n\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;, &#x27;body is not object&#x27;);\n\t\tassert.strictEqual(typeof res.body.file, &#x27;object&#x27;, &#x27;body.file is not object&#x27;);\t\t\t\t\n\t\tassert.strictEqual(res.body.path, path, &#x27;body.path != &#x27;+path);\n\t\tassert.strictEqual(fs.pathExistsSync(path), true, &#x27;uploaded file does not exists&#x27;);\n\t\tassert.strictEqual(fs.statSync(path).size != 0, true, &#x27;uploaded file size != 0&#x27;);\n\t\t\n\t\tdone();\t\t\t\t\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;afba60bb-1443-46a4-885d-9af0e14d4bbe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;afba60bb-1443-46a4-885d-9af0e14d4bbe&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:663,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b182ed66-25af-461d-9793-653cb02d718a&quot;,&quot;title&quot;:&quot;upload no file&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/upload upload no file should return error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:656,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir+&#x27;/upload2.txt&#x27;\n\tif (fs.pathExistsSync(path))\n\t\tfs.unlinkSync(path)\n\tlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/upload?path=&#x27;+path)\n\t\n\topt.formData = {\n        name: sourceFileName,\n    },\n\t\t\t\n\texecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;868c3b9f-8e3a-4d38-bb43-be815f069741&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;868c3b9f-8e3a-4d38-bb43-be815f069741&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:656,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;681414bf-fbef-4424-b552-e82b06cf31de&quot;,&quot;title&quot;:&quot;upload file - dest is directory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400 (dest is a directory)&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/upload upload file - dest is directory should return 400 (dest is a directory)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir\n\tlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/upload?path=&#x27;+path)\n\t\n\topt.formData = {\n        // Like &lt;input type=\&quot;text\&quot; name=\&quot;name\&quot;&gt;\n        name: sourceFileName,\n        // Like &lt;input type=\&quot;file\&quot; name=\&quot;file\&quot;&gt;\n        file: {\n            value: fs.createReadStream(sourceFile),\n            options: {\n                filename: sourceFileName,\n                contentType: &#x27;application/javascript&#x27;\n            }\n        }\n    },\n\t\t\t\n\texecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8624165e-9bfc-4725-9120-3683c52e10ff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8624165e-9bfc-4725-9120-3683c52e10ff&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7211f939-1cff-402f-953f-5d1c9993fb71&quot;,&quot;title&quot;:&quot;upload file - dest directory does not exist&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400 (dest a directory does not exist)&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/upload upload file - dest directory does not exist should return 400 (dest a directory does not exist)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir+&#x27;/uploadblablabla/upload.txt&#x27;\n\tlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/upload?path=&#x27;+path)\n\t\n\topt.formData = {\n        // Like &lt;input type=\&quot;text\&quot; name=\&quot;name\&quot;&gt;\n        name: sourceFileName,\n        // Like &lt;input type=\&quot;file\&quot; name=\&quot;file\&quot;&gt;\n        file: {\n            value: fs.createReadStream(sourceFile),\n            options: {\n                filename: sourceFileName,\n                contentType: &#x27;application/javascript&#x27;\n            }\n        }\n    },\n\t\t\t\n\texecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4e94e289-30cd-4593-9a61-d803735b9be6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4e94e289-30cd-4593-9a61-d803735b9be6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;41b07ae8-0ca1-4d1d-8cfd-8f7bc1eb44bd&quot;,&quot;title&quot;:&quot;upload existing file - overwrite=false&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return error&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/upload upload existing file - overwrite=false should return error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir+&#x27;/upload.txt&#x27;\n\tlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/upload?path=&#x27;+path+&#x27;&amp;overwrite=false&#x27;)\n\t\n\topt.formData = {\n        // Like &lt;input type=\&quot;text\&quot; name=\&quot;name\&quot;&gt;\n        name: sourceFileName,\n        // Like &lt;input type=\&quot;file\&quot; name=\&quot;file\&quot;&gt;\n        file: {\n            value: fs.createReadStream(sourceFile),\n            options: {\n                filename: sourceFileName,\n                contentType: &#x27;application/javascript&#x27;\n            }\n        }\n    },\n\t\t\t\n\texecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ac630351-74d3-45a6-aa5f-8265090ff115&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ac630351-74d3-45a6-aa5f-8265090ff115&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;bb64e925-533e-48aa-85ee-e7379c8a25e1&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/deleteFiles&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0e0a32ea-8282-4050-9033-16cb0d0a0f25&quot;,&quot;title&quot;:&quot;delete existing file&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/deleteFiles delete existing file should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir+&#x27;/fileToDelete.txt&#x27;\n\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/deleteFiles&#x27;)\nopt.body = {\n\tpath: path\n}\nfs.writeFileSync(path, &#x27;test&#x27;)\n\t\t\nrequest( opt )\n.then( (res) =&gt; {\t\n\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(fs.pathExistsSync(path), false);\n\tassert.strictEqual(res.body.result, true);\n\tassert.strictEqual(typeof res.body.filename, &#x27;string&#x27;);\n\tassert.strictEqual(res.body.path, path);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;defa3a87-d527-49b4-acc4-125eb182367f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;defa3a87-d527-49b4-acc4-125eb182367f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;70ea1bb9-7af5-43cb-83f7-6a8a9ddc74cf&quot;,&quot;title&quot;:&quot;delete existing directory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/deleteFiles delete existing directory should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir+&#x27;/directoryToDelete&#x27;\nfs.mkdirpSync(path)\nfs.writeFileSync(path+\&quot;/test1.txt\&quot;, &#x27;test&#x27;)\nfs.writeFileSync(path+\&quot;/test2.txt\&quot;, &#x27;test&#x27;)\n\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/deleteFiles&#x27;)\nopt.body = {\n\tpath: path\n}\nrequest( opt )\n.then( (res) =&gt; {\t\n\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(fs.pathExistsSync(path), false);\n\tassert.strictEqual(res.body.result, true);\n\tassert.strictEqual(typeof res.body.filename, &#x27;string&#x27;);\n\tassert.strictEqual(res.body.path, path);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;70fd4ea2-7805-431f-bf83-0919326ac15e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;70fd4ea2-7805-431f-bf83-0919326ac15e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c4ec8f9c-9016-4361-8e8a-37e505dafecd&quot;,&quot;title&quot;:&quot;delete not existing file&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 404&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/deleteFiles delete not existing file should return 404&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = tmpDir+&#x27;/fileToDelete.txt&#x27;\n\nlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/filesystem/deleteFiles&#x27;)\nopt.body = {\n\tpath: path\n}\nif (fs.pathExistsSync(path))\n\tfs.unlinkSync(path)\n\t\t\nexecRequestExpectError(opt, done, 404)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;40f70717-271c-4c27-81b4-1af947085c6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;40f70717-271c-4c27-81b4-1af947085c6a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7cbcae7e-e0e6-4f94-a7b0-4a844e90a423&quot;,&quot;title&quot;:&quot;/_plugin/filesystem/download&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8d9df703-d150-40f9-898d-a849a013ea73&quot;,&quot;title&quot;:&quot;Download existing file&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/download Download existing file should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let query = &#x27;path=&#x27;+sourceFile\nlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/download?&#x27;+query)\nopt.json = false\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;string&#x27;);\n\tassert.strictEqual(res.headers[&#x27;content-type&#x27;], &#x27;application/javascript; charset=UTF-8&#x27;);\n\tassert.strictEqual(res.headers[&#x27;content-disposition&#x27;], &#x27;attachment; filename=\&quot;index.js\&quot;&#x27;);\n\tassert.strictEqual(res.headers[&#x27;content-length&#x27;] &gt; 0 , true, &#x27;content-type &gt; 0&#x27;);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0f9507d2-4955-4f56-bf02-00180d04fa85&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0f9507d2-4955-4f56-bf02-00180d04fa85&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;422af8b1-ec9d-4932-a460-f63e38480bc5&quot;,&quot;title&quot;:&quot;Download existing file - compress=false&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/download Download existing file - compress=false should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let query = &#x27;path=&#x27;+sourceFile+&#x27;&amp;compress=false&#x27;\nlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/download?&#x27;+query)\nopt.json = false\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;string&#x27;);\n\t/*assert.strictEqual(res.headers[&#x27;content-type&#x27;], &#x27;application/javascript&#x27;);\n\tassert.strictEqual(res.headers[&#x27;content-disposition&#x27;], &#x27;attachment; filename=\&quot;index.js\&quot;&#x27;);*/\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;982e8db5-c267-44e1-9068-fc27d9995a76&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;982e8db5-c267-44e1-9068-fc27d9995a76&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1fa8438e-5f2f-4632-baee-457eca51eb59&quot;,&quot;title&quot;:&quot;Download file - file does not exists&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 404&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/download Download file - file does not exists should return 404&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let query = &#x27;path=&#x27;+sourceFile+&#x27;/balbalba&#x27;\nlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/download?&#x27;+query)\nexecRequestExpectError(opt, done, 404)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;22e933a9-0241-4a0a-a96e-5cfbbc7e2b60&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;22e933a9-0241-4a0a-a96e-5cfbbc7e2b60&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2a4c4c13-4747-4cf1-9b91-e23d7e88bb62&quot;,&quot;title&quot;:&quot;Download directory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\20-plugin-filesystem.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/filesystem/download Download directory should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:449,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let query = &#x27;path=&#x27;+sourceDir\nlet dest = tmpDir+&#x27;/downloadZip.zip&#x27;\nlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/filesystem/download?&#x27;+query)\nopt.json = false\nif (fs.pathExistsSync(dest))\n\tfs.unlinkSync(dest)\nlet destFileStream = fs.createWriteStream(dest);\nrequest( opt , (error, res, body) =&gt; {\n\tassert.strictEqual(res.statusCode, 200);\n\tassert.strictEqual(typeof res.body, &#x27;string&#x27;);\n\tassert.strictEqual(res.headers[&#x27;content-type&#x27;], &#x27;application/zip&#x27;);\n\tassert.strictEqual(res.headers[&#x27;content-disposition&#x27;], &#x27;attachment; filename=\&quot;dist.zip\&quot;&#x27;);\t\t\n})\n.pipe(destFileStream)\n\t\t    .on(&#x27;finish&#x27;, () =&gt; {\n\n\t\t    \tif (fs.pathExistsSync(dest) &amp;&amp; (fs.statSync(dest).size &gt; 0))\n\t\t       \t\tdone();\t\t \t      \n\t\t       \telse\n\t\t       \t\tdone(&#x27;Downloaded file does not exists or is empty&#x27;);\t\t \t      \n\t\t    })\n\t\t    .on(&#x27;error&#x27;, (error) =&gt; {\n\t\t        done(error);\n\t\t    })&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8ccd0c64-6b42-4c56-af77-5f1047086c79&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8ccd0c64-6b42-4c56-af77-5f1047086c79&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:449,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e053e3a7-dc1a-4829-840f-1f8fc4219f8e&quot;,&quot;title&quot;:&quot;plugin-http&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\30-plugin-http.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\30-plugin-http.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;71cf9669-8f26-467a-911e-a7c93215db7c&quot;,&quot;title&quot;:&quot;POST /_plugin/http/request&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\30-plugin-http.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\30-plugin-http.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;plugin-http POST /_plugin/http/request should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/http/request&#x27;)\nopt.body = {\n\turl: &#x27;http://&#x27;+HOST+&#x27;:&#x27;+PORT+&#x27;/api/checkAgent&#x27;,\n\tmethod: &#x27;GET&#x27;,\n\tjson: true\n}\nrequest( opt )\n.then( (res) =&gt; {\t\t\n\t//console.log(res.body)\t\n\texpect(res.statusCode).to.equal(200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(typeof res.body.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.body.status, 0);\n\texpect(res.body.status).to.equal(200);\n\tassert.strictEqual(typeof res.body.body.version, &#x27;string&#x27;);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d4b4cd92-f702-42e8-ab7e-376bea97d596&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d4b4cd92-f702-42e8-ab7e-376bea97d596&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;01eb8ea6-f9a9-4a9e-8476-5cc6cbcedad2&quot;,&quot;title&quot;:&quot;POST /_plugin/http/request to unkown host&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\30-plugin-http.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\30-plugin-http.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200 - content is error&quot;,&quot;fullTitle&quot;:&quot;plugin-http POST /_plugin/http/request to unkown host should return 200 - content is error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:17,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/http/request&#x27;)\nopt.body = {\n\turl: &#x27;http://&#x27;+HOST+&#x27;blablabla:&#x27;+PORT+&#x27;/api/checkAgent&#x27;,\n\tmethod: &#x27;GET&#x27;,\n\tjson: true\n}\nrequest( opt )\n.then( (res) =&gt; {\t\t\n\t//console.log(res.body)\t\n\texpect(res.statusCode).to.equal(200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.isError, true);\n\tassert.strictEqual(typeof res.body.error !== &#x27;undefined&#x27;, true);\n\tassert.strictEqual(res.body.status, null);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0e9b56e3-d781-4d26-83b3-444e6d7a97a5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0e9b56e3-d781-4d26-83b3-444e6d7a97a5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:17,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a7cda43e-6045-464e-86df-4cb9aada1447&quot;,&quot;title&quot;:&quot;POST /_plugin/http/request to unkown url&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\30-plugin-http.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\30-plugin-http.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200 - content is error 404&quot;,&quot;fullTitle&quot;:&quot;plugin-http POST /_plugin/http/request to unkown url should return 200 - content is error 404&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/http/request&#x27;)\nopt.body = {\n\turl: &#x27;http://&#x27;+HOST+&#x27;:&#x27;+PORT+&#x27;/api/checkAgentBLABLABLA&#x27;,\n\tmethod: &#x27;GET&#x27;,\n\tjson: true\n}\nrequest( opt )\n.then( (res) =&gt; {\t\t\n\t//console.log(res.body)\t\n\texpect(res.statusCode).to.equal(200);\n\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\tassert.strictEqual(res.body.isError, false);\n\tassert.strictEqual(res.body.error, null);\n\tassert.strictEqual(res.body.status, 404);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;8ae0ad9e-555e-4615-9896-83b31867e5d5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8ae0ad9e-555e-4615-9896-83b31867e5d5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b59e9666-bdd7-4f06-b88c-96f8a7c78f36&quot;,&quot;title&quot;:&quot;plugin-metrics&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3dbb3539-11d3-4769-9744-9234089d352b&quot;,&quot;title&quot;:&quot;GET metrics getInfos&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return object&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics getInfos should return object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual( _.isArray(res.body.metrics) , true, &#x27;body.metrics is not array&#x27;)\t\t\n\t\t\t\tassert.strictEqual( res.body.metrics.length , 5, &#x27;body.metrics length is not 5&#x27;)\t\t\n\t\t\t\tlet cpuMetric =  res.body.metrics[0]\n\t\t\t\tassert.strictEqual( cpuMetric.name , &#x27;cpu&#x27;)\t\t\t\n\t\t\t\tassert.strictEqual( cpuMetric.url , &#x27;http://&#x27;+HOST+&#x27;:&#x27;+PORT+&#x27;/_plugin/metrics/cpu&#x27;)\t\t\t\n\t\t\t\tassert.strictEqual( _.isArray(cpuMetric.args) , true, &#x27;body.metrics[0].args is not array&#x27;)\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;79dcece5-95fd-4cdb-88aa-6f0999de0cc7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;79dcece5-95fd-4cdb-88aa-6f0999de0cc7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;95657d94-a7c1-4bb7-9fdc-f8083c1cdb88&quot;,&quot;title&quot;:&quot;GET metrics systemInfo&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return object&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics systemInfo should return object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:17,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/systemInfo&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.release == &#x27;string&#x27;, true, \&quot;&#x27;release&#x27; property is not number\&quot;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.uptime == &#x27;number&#x27;, true, \&quot;&#x27;uptime&#x27; property is not number&#x27;\&quot;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.osType == &#x27;string&#x27;, true, \&quot;&#x27;osType&#x27; property is not number&#x27;\&quot;)\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a0541e31-1b40-473c-8ab0-00a386088e5b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a0541e31-1b40-473c-8ab0-00a386088e5b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:17,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4742095a-eaca-462d-94be-be4133b7af6a&quot;,&quot;title&quot;:&quot;GET metrics systemInfo format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return string&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics systemInfo format=nagios should return string&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/systemInfo?format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, false, 0 )\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;99a7c6b9-f8b3-4c95-80b8-8f5ddb792a1d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;99a7c6b9-f8b3-4c95-80b8-8f5ddb792a1d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;dc18ce44-fd4c-40be-822a-6f4af22db35d&quot;,&quot;title&quot;:&quot;GET metrics cpu&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return object&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics cpu should return object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1005,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/cpu&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.ellapsed == &#x27;number&#x27;, true, \&quot;&#x27;ellapsed&#x27; property is not number\&quot;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.percentageCPU == &#x27;number&#x27;, true, \&quot;&#x27;percentageCPU&#x27; property is not number&#x27;\&quot;)\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;000cbf28-be2d-422a-b3a4-a8962523bd29&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;000cbf28-be2d-422a-b3a4-a8962523bd29&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1005,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2206cd97-1f79-42ba-9a3e-dc25b3385256&quot;,&quot;title&quot;:&quot;GET metrics cpu format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return string&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics cpu format=nagios should return string&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1006,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/cpu?format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true )\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7cc3c190-e379-4c6e-97ae-473f103e7fea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7cc3c190-e379-4c6e-97ae-473f103e7fea&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1006,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7283b732-4353-4734-808a-e7e6e16d337c&quot;,&quot;title&quot;:&quot;GET metrics cpu warn=10 critic=5 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 3&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics cpu warn=10 critic=5 format=nagios should return currentState 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1007,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/cpu?warn=10&amp;critic=5&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, false, 3 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;70d7ca7e-1e17-4ada-9219-2585eda4151c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;70d7ca7e-1e17-4ada-9219-2585eda4151c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1007,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;67146724-752f-4b81-85f0-78f0604fa3d9&quot;,&quot;title&quot;:&quot;GET metrics cpu warn=0 critic=0 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 2&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics cpu warn=0 critic=0 format=nagios should return currentState 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1010,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/cpu?warn=0&amp;critic=0&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true, 2 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0f66a21f-e5d5-4fea-868b-d9961e703bcb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0f66a21f-e5d5-4fea-868b-d9961e703bcb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1010,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6561d183-3f90-4a21-bdeb-d1319038c096&quot;,&quot;title&quot;:&quot;GET metrics cpu warn=0 critic=100 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 1&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics cpu warn=0 critic=100 format=nagios should return currentState 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1019,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/cpu?warn=0&amp;critic=100&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true, 1 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;a78278f5-4f62-4a98-9255-988a2144a3fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a78278f5-4f62-4a98-9255-988a2144a3fe&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1019,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d3fed9cb-cdf4-47a2-af16-c1f5d24e2f97&quot;,&quot;title&quot;:&quot;GET metrics memory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return object&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics memory should return object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/memory&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.usedPercent == &#x27;number&#x27;, true, \&quot;&#x27;usedPercent&#x27; property is not number\&quot;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.usedMem == &#x27;number&#x27;, true, \&quot;&#x27;usedMem&#x27; property is not number&#x27;\&quot;)\t\t\t\t\t\n\t\t\t\tassert.strictEqual(typeof res.body.totalMem == &#x27;number&#x27;, true, \&quot;&#x27;totalMem&#x27; property is not number&#x27;\&quot;)\t\t\t\t\t\n\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4318f7af-f236-4a6d-bf64-fdd86fb977f9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4318f7af-f236-4a6d-bf64-fdd86fb977f9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d9a92f06-76a2-4d3e-8ca5-63b9dd379b4a&quot;,&quot;title&quot;:&quot;GET metrics memory format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return string&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics memory format=nagios should return string&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/memory?format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\t\n\t\t\t\tcheckNagiosResult( res, true )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fd806093-f324-446c-aad0-6e95ffac1d2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fd806093-f324-446c-aad0-6e95ffac1d2a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e31216d4-57ec-4484-ad3a-f225c0680da1&quot;,&quot;title&quot;:&quot;GET metrics memory warn=10 critic=5 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 3&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics memory warn=10 critic=5 format=nagios should return currentState 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/memory?warn=10&amp;critic=5&amp;format=nagios&#x27;) )\n.then( (res) =&gt; {\t\t\n\tcheckNagiosResult( res, false, 3)\t\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;54b024a3-e231-49f7-a678-f9e464603f09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;54b024a3-e231-49f7-a678-f9e464603f09&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;77abe16a-24a6-4b35-bd18-cb779e882989&quot;,&quot;title&quot;:&quot;GET metrics memory warn=0 critic=0 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 2&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics memory warn=0 critic=0 format=nagios should return currentState 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/memory?warn=0&amp;critic=0&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true, 2 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;13dd896e-4ff4-414a-9a08-302ff44d06af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;13dd896e-4ff4-414a-9a08-302ff44d06af&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;af7b2cff-e41e-42ad-bd85-f12ebe13deab&quot;,&quot;title&quot;:&quot;GET metrics memory warn=0 critic=100 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 1&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics memory warn=0 critic=100 format=nagios should return currentState 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/memory?warn=0&amp;critic=100&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true, 1 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;43974fa4-9829-44a9-8371-21236192206b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;43974fa4-9829-44a9-8371-21236192206b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a2b54b25-f396-4f4b-ac4b-e00bd9f8a643&quot;,&quot;title&quot;:&quot;GET metrics load&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return object&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics load should return object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/load&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.load1 == &#x27;number&#x27;, true, \&quot;&#x27;load1&#x27; property is not number\&quot;)\t\n\t\t\t\tassert.strictEqual(typeof res.body.load5 == &#x27;number&#x27;, true, \&quot;&#x27;load5&#x27; property is not number&#x27;\&quot;)\t\t\t\t\t\n\t\t\t\tassert.strictEqual(typeof res.body.load15 == &#x27;number&#x27;, true, \&quot;&#x27;load15&#x27; property is not number&#x27;\&quot;)\t\t\t\t\t\n\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;52090318-bcb1-46aa-a1c2-93c6774f1c60&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;52090318-bcb1-46aa-a1c2-93c6774f1c60&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;60e63dd5-cb17-4b10-bb39-27c569b28595&quot;,&quot;title&quot;:&quot;GET metrics load format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return string&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics load format=nagios should return string&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/load?format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\t\n\t\t\t\tcheckNagiosResult( res, true )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;cd443423-5418-446d-a301-bd96803efafb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cd443423-5418-446d-a301-bd96803efafb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2c96c053-19f4-4487-aee6-1c75c15686f9&quot;,&quot;title&quot;:&quot;GET metrics load warn=10 critic=5 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 3&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics load warn=10 critic=5 format=nagios should return currentState 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/load?warn=10&amp;critic=5&amp;format=nagios&#x27;) )\n.then( (res) =&gt; {\t\t\n\tcheckNagiosResult( res, false, 3)\t\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2d3088c7-7a4d-45b0-9082-8c34ef9f31fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2d3088c7-7a4d-45b0-9082-8c34ef9f31fd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0aab28e1-b512-4749-96b7-d21a5e21eca4&quot;,&quot;title&quot;:&quot;GET metrics load warn1=10 critic1=5 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 3&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics load warn1=10 critic1=5 format=nagios should return currentState 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/load?warn1=10&amp;critic1=5&amp;format=nagios&#x27;) )\n.then( (res) =&gt; {\t\t\n\tcheckNagiosResult( res, false, 3)\t\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;744b260f-7b89-4dea-988c-e0718ee001c0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;744b260f-7b89-4dea-988c-e0718ee001c0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;15b6e06f-043f-448a-8923-055546e0e992&quot;,&quot;title&quot;:&quot;GET metrics load warn5=10 critic5=5 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 3&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics load warn5=10 critic5=5 format=nagios should return currentState 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/load?warn5=10&amp;critic5=5&amp;format=nagios&#x27;) )\n.then( (res) =&gt; {\t\t\n\tcheckNagiosResult( res, false, 3)\t\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;efb20c4c-b3bd-4b45-a853-d32bd168666d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;efb20c4c-b3bd-4b45-a853-d32bd168666d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2c3fb79b-325c-44cb-9199-0c344d55b447&quot;,&quot;title&quot;:&quot;GET metrics load warn15=10 critic15=5 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 3&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics load warn15=10 critic15=5 format=nagios should return currentState 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/load?warn15=10&amp;critic15=5&amp;format=nagios&#x27;) )\n.then( (res) =&gt; {\t\t\n\tcheckNagiosResult( res, false, 3)\t\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9dc3961a-e98c-442f-860e-00208b967d68&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9dc3961a-e98c-442f-860e-00208b967d68&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;cccb2abf-8c26-4c8f-a366-0d425f8bc078&quot;,&quot;title&quot;:&quot;GET metrics load warn=0 critic=0 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 2&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics load warn=0 critic=0 format=nagios should return currentState 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/load?warn=0&amp;critic=0&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true, 2 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;d1d8787e-6eec-4adb-969a-c0976cde71a6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d1d8787e-6eec-4adb-969a-c0976cde71a6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;3715585d-6399-4bb8-a5dd-de5e4834eab8&quot;,&quot;title&quot;:&quot;GET metrics load warn=0 critic=100 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 1&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics load warn=0 critic=100 format=nagios should return currentState 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/load?warn=0&amp;critic=100&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true, 1 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;108574df-2f2a-46ba-958b-b2cdbace6e92&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;108574df-2f2a-46ba-958b-b2cdbace6e92&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;228cff7d-c053-4fe8-8044-5017e4e32d4b&quot;,&quot;title&quot;:&quot;GET metrics disks&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return object&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics disks should return object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:591,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/disks&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\n\t\t\t\texpect(res.statusCode).to.equal(200);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;)\t\n\t\t\t\t/*\n\t\t\t\t{\n\t\t\t\t\tC:: {\n\t\t\t\t\tname: \&quot;C:\&quot;,\n\t\t\t\t\tfree: 5695320064,\n\t\t\t\t\ttotal: 128033222656,\n\t\t\t\t\tused: 122337902592,\n\t\t\t\t\ttotalGO: 119.2,\n\t\t\t\t\tusedGO: 113.9,\n\t\t\t\t\tfreeGO: 5.3,\n\t\t\t\t\tusedPercent: 96,\n\t\t\t\t\tisValid: true\n\t\t\t\t\t},\n\t\t\t\t*/\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;110551a0-6bf5-495a-9db2-324a8e0c0265&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;110551a0-6bf5-495a-9db2-324a8e0c0265&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:591,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a3d3cd3b-ecfe-4248-b456-4f1b7cd64df4&quot;,&quot;title&quot;:&quot;GET metrics disks format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return string&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics disks format=nagios should return string&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:624,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/disks?format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\t\n\t\t\t\tcheckNagiosResult( res, true )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;13c3eeca-9e59-4206-bbb4-f509e0eaf590&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;13c3eeca-9e59-4206-bbb4-f509e0eaf590&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:624,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;fd201c08-4e6a-4a45-aa73-2c526f78ef13&quot;,&quot;title&quot;:&quot;GET metrics disks warn=10 critic=5 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 3&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics disks warn=10 critic=5 format=nagios should return currentState 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:704,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/disks?warn=10&amp;critic=5&amp;format=nagios&#x27;) )\n.then( (res) =&gt; {\t\t\n\tcheckNagiosResult( res, false, 3)\t\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;58930dcf-fa81-49f1-990a-d79b94e5a41f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;58930dcf-fa81-49f1-990a-d79b94e5a41f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:704,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;17ac3db3-0ebe-4040-b89c-bca53979b592&quot;,&quot;title&quot;:&quot;GET metrics disks fs=blablabla format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 3&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics disks fs=blablabla format=nagios should return currentState 3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:594,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/disks?fs=blablabla&amp;format=nagios&#x27;) )\n.then( (res) =&gt; {\t\t\n\tcheckNagiosResult( res, false, 3)\t\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6aab7685-c3ff-4138-8e1b-fa5aed25050e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6aab7685-c3ff-4138-8e1b-fa5aed25050e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:594,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;593360cb-7f8e-4372-90d8-12ab5db2ff1e&quot;,&quot;title&quot;:&quot;GET metrics disks warn=0 critic=0 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 2&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics disks warn=0 critic=0 format=nagios should return currentState 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:600,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/disks?warn=0&amp;critic=0&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true, 2 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3211a351-bc45-4214-a2e9-f079b4913a40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3211a351-bc45-4214-a2e9-f079b4913a40&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:600,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8b73c7eb-2f92-49d6-9783-1f7d0ca207d3&quot;,&quot;title&quot;:&quot;GET metrics disks warn=0 critic=100 format=nagios&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\40-plugin-metrics.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return currentState 1&quot;,&quot;fullTitle&quot;:&quot;plugin-metrics GET metrics disks warn=0 critic=100 format=nagios should return currentState 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:611,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;request( getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/metrics/disks?warn=0&amp;critic=100&amp;format=nagios&#x27;) )\n\t\t\t.then( (res) =&gt; {\t\t\n\t\t\t\tcheckNagiosResult( res, true, 1 )\t\t\t\t\t\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4649fb10-6f0a-464b-a2a0-917a06957b35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4649fb10-6f0a-464b-a2a0-917a06957b35&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:611,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;34ea59bb-0d17-4606-ba59-59d3758d68e3&quot;,&quot;title&quot;:&quot;GET /_plugin/ssh&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 404&quot;,&quot;fullTitle&quot;:&quot;GET /_plugin/ssh should return 404&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/ssh&#x27;)\nexecRequestExpectError(opt, done, 404)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;343fdc3f-10a1-4759-94f0-40670669c6d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;343fdc3f-10a1-4759-94f0-40670669c6d7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;d141083a-ac59-4fc5-9f1f-0b01cb0a9a45&quot;,&quot;title&quot;:&quot;/_plugin/ssh/upload&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;999e86fe-36ee-457a-b2ea-1bd11633d3bc&quot;,&quot;title&quot;:&quot;upload file&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh/upload upload file should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:773,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = &#x27;/tmp/upload.txt&#x27;\n\tlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/upload?path=&#x27;+path+&#x27;&amp;port=&#x27;+SSH_HOST_PORT+&#x27;&amp;host=&#x27;+SSH_HOST+&#x27;&amp;username=&#x27;+SSH_HOST_USERNAME+&#x27;&amp;password=&#x27;+SSH_HOST_PASSWORD)\n\t\n\topt.formData = {\n        // Like &lt;input type=\&quot;text\&quot; name=\&quot;name\&quot;&gt;\n        name: sourceFileName,\n        // Like &lt;input type=\&quot;file\&quot; name=\&quot;file\&quot;&gt;\n        file1: {\n            value: fs.createReadStream(sourceFile),\n            options: {\n                filename: sourceFileName,\n                contentType: &#x27;application/javascript&#x27;\n            }\n        },\n        file2: {\n            value: fs.createReadStream(sourceDir+&#x27;/Application.js&#x27;),\n            options: {\n                filename: &#x27;Application.js&#x27;,\n                contentType: &#x27;application/javascript&#x27;\n            }\n        }\n    },\n\t\t\t\n\trequest( opt )\n\t.then( (res) =&gt; {\t\n\t\tcheckUploadResult( res, sourceFile, path  )\n\t\tdone();\t\t\t\t\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0f7c1f7a-d9e2-4c1c-8ca2-8b9bf5b44ce0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0f7c1f7a-d9e2-4c1c-8ca2-8b9bf5b44ce0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:773,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;776084a1-eabe-4b80-9383-969a4ca064ef&quot;,&quot;title&quot;:&quot;upload file in incorrect path&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh/upload upload file in incorrect path should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:656,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let path = &#x27;/blablabla/upload.txt&#x27;\n\tlet opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/upload?path=&#x27;+path+&#x27;&amp;port=&#x27;+SSH_HOST_PORT+&#x27;&amp;host=&#x27;+SSH_HOST+&#x27;&amp;username=&#x27;+SSH_HOST_USERNAME+&#x27;&amp;password=&#x27;+SSH_HOST_PASSWORD)\n\t\n\topt.formData = {\n        // Like &lt;input type=\&quot;text\&quot; name=\&quot;name\&quot;&gt;\n        name: sourceFileName,\n        // Like &lt;input type=\&quot;file\&quot; name=\&quot;file\&quot;&gt;\n        file1: {\n            value: fs.createReadStream(sourceFile),\n            options: {\n                filename: sourceFileName,\n                contentType: &#x27;application/javascript&#x27;\n            }\n        }\n    }\n\t\t\t\n\texecRequestExpectError( opt, done, 400 )&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6a3402e1-a064-4b43-b2dd-d2f487d2fd22&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6a3402e1-a064-4b43-b2dd-d2f487d2fd22&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:656,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9af88526-beda-4c25-abb8-33dba8905d10&quot;,&quot;title&quot;:&quot;/_plugin/ssh with password&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;130a54e8-2131-4cb7-9bcd-03ce57a36a97&quot;,&quot;title&quot;:&quot;exec script on unknown host&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 500&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh with password exec script on unknown host should return 500&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2258,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/exec&#x27;)\n\t\n\topt.body = {\n\t\tscript:  \&quot;ls -l\&quot;,\n\t\thost: &#x27;blablabla&#x27;,\n\t\tport: SSH_HOST_PORT,\n\t\tusername: SSH_HOST_USERNAME,\n\t\tpassword: SSH_HOST_PASSWORD\n\t}\n    \n\texecRequestExpectError(opt, null, 500)\n\t.then( res =&gt; {\n\t\tcheckSshError(res, &#x27;SshError&#x27;, false, &#x27;client-socket&#x27;)\n\t\tdone()\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;afec51de-c28c-46eb-bfdf-da7135c21862&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;afec51de-c28c-46eb-bfdf-da7135c21862&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2258,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:25000},{&quot;uuid&quot;:&quot;a82fa1ed-2d2b-4321-9470-9d66f86c0d2a&quot;,&quot;title&quot;:&quot;exec script with incorrect password&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 500&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh with password exec script with incorrect password should return 500&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2009,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/exec&#x27;)\n\t\n\topt.body = {\n\t\tscript:  \&quot;ls -l\&quot;,\n\t\thost: SSH_HOST,\n\t\tport: SSH_HOST_PORT,\n\t\tusername: SSH_HOST_USERNAME,\n\t\tpassword: &#x27;blablabla&#x27;\n\t}\n    \n\texecRequestExpectError(opt, null, 500)\n\t.then( res =&gt; {\n\t\tcheckSshError(res, &#x27;SshError&#x27;, false, &#x27;client-authentication&#x27;)\n\t\tdone()\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;90e896dd-1446-4126-b090-e719cd3c62e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;90e896dd-1446-4126-b090-e719cd3c62e2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2009,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:25000},{&quot;uuid&quot;:&quot;a6c9b219-f878-490c-8aec-be2392a7663a&quot;,&quot;title&quot;:&quot;exec script&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh with password exec script should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:609,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/exec&#x27;)\n\t\n\topt.body = {\n\t\tscript:  \&quot;echo $USER\&quot;,\n\t\thost: SSH_HOST,\n\t\tport: SSH_HOST_PORT,\n\t\tusername: SSH_HOST_USERNAME,\n\t\tpassword: SSH_HOST_PASSWORD\n\t}\n    \n    request( opt )\n\t.then( (res) =&gt; {\t\n\t\t\n\t\tassert.strictEqual(res.statusCode, 200, &#x27;status is not 200&#x27;);\n\t\tassert.strictEqual(res.body.stdout.trim(), SSH_HOST_USERNAME, &#x27;stdout != &#x27;+SSH_HOST_USERNAME);\n\t\tassert.strictEqual(res.body.stderr, &#x27;&#x27;, &#x27;stderr is not empty&#x27;);\n\t\tassert.strictEqual(res.body.exitCode, 0, &#x27;exitCode != 0&#x27;);\n\t\tdone();\t\t\t\t\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c4ab70db-589d-4e01-acd5-5f57434a8acb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c4ab70db-589d-4e01-acd5-5f57434a8acb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:609,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b75056c7-40be-4d48-bab0-9ab263e13b55&quot;,&quot;title&quot;:&quot;exec script with stderr and exitCode=1&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh with password exec script with stderr and exitCode=1 should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:60,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/exec&#x27;)\n\t\n\topt.body = {\n\t\tscript:  \&quot;cd /blablabla\&quot;,\n\t\thost: SSH_HOST,\n\t\tport: SSH_HOST_PORT,\n\t\tusername: SSH_HOST_USERNAME,\n\t\tpassword: SSH_HOST_PASSWORD\n\t}\n    \n    request( opt )\n\t.then( (res) =&gt; {\t\n\t\tassert.strictEqual(res.statusCode, 200, &#x27;status is not 200&#x27;);\n\t\tassert.strictEqual(res.body.stderr.trim() !== &#x27;&#x27;, true, &#x27;stderr is empty&#x27;);\n\t\tassert.strictEqual(res.body.exitCode, 1, &#x27;exitCode != 0&#x27;);\n\t\tdone();\t\t\t\t\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7333e7dc-b511-4873-874f-aca5f69d4077&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7333e7dc-b511-4873-874f-aca5f69d4077&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:60,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a02e04b2-c4cd-45ce-9a6f-bad162339f98&quot;,&quot;title&quot;:&quot;/_plugin/ssh sftpReaddir&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;9131310d-e14d-4e7a-a898-2184cfa6333d&quot;,&quot;title&quot;:&quot;sftpReaddir&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh sftpReaddir sftpReaddir should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:770,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let params = &#x27;path=/tmp&amp;host=&#x27;+SSH_HOST+&#x27;&amp;username=&#x27;+SSH_HOST_USERNAME+&#x27;&amp;password=&#x27;+SSH_HOST_PASSWORD+&#x27;&amp;port=&#x27;+SSH_HOST_PORT\n\t\t\tlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/ssh/sftpReaddir?&#x27;+params)\n\t\t\t    \n\t\t    request( opt )\n\t\t\t.then( (res) =&gt; {\t\n\t\t\t\t\n\t\t\t\tassert.strictEqual(res.statusCode, 200, &#x27;status is not 200&#x27;);\n\t\t\t\tassert.strictEqual(typeof res.body, &#x27;object&#x27;);\n\t\t\t\tassert.strictEqual(typeof res.body.result, &#x27;object&#x27;, &#x27;result is not object&#x27;);\n\t\t\t\tdone();\t\t\t\t\n\t\t\t})\n\t\t\t.catch( err =&gt; {\n\t\t\t\tdone(err)\n\t\t\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fbc4de2c-9d18-4740-829c-bd077099f3b0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fbc4de2c-9d18-4740-829c-bd077099f3b0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:770,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2be9fed3-c1a8-4a3e-be74-c161fe2fcda2&quot;,&quot;title&quot;:&quot;sftpReadir with no path&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh sftpReaddir sftpReadir with no path should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let params = &#x27;host=&#x27;+SSH_HOST+&#x27;&amp;username=&#x27;+SSH_HOST_USERNAME+&#x27;&amp;password=&#x27;+SSH_HOST_PASSWORD+&#x27;&amp;port=&#x27;+SSH_HOST_PORT\n\t\t\tlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/ssh/sftpReaddir?&#x27;+params)\n\t\t\t\n\t\t    execRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;3094a82d-cdb3-4c5e-a45f-15d8ff66aca8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3094a82d-cdb3-4c5e-a45f-15d8ff66aca8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;2acca297-f25a-4833-b650-268fa070c845&quot;,&quot;title&quot;:&quot;sftpReadir with incorrect path&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh sftpReaddir sftpReadir with incorrect path should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:645,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let params = &#x27;path=/dfgdfsgfdsgdsfg&amp;host=&#x27;+SSH_HOST+&#x27;&amp;username=&#x27;+SSH_HOST_USERNAME+&#x27;&amp;password=&#x27;+SSH_HOST_PASSWORD+&#x27;&amp;port=&#x27;+SSH_HOST_PORT\n\t\t\tlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/ssh/sftpReaddir?&#x27;+params)\n\t\t\t\n\t\t    execRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;096db0e2-76d2-4c71-b620-cf0d337db8a2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;096db0e2-76d2-4c71-b620-cf0d337db8a2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:645,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;60ba3c55-e76b-4426-b83d-60cfa8a0d226&quot;,&quot;title&quot;:&quot;/_plugin/ssh with remote key&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6a21ca72-8f9f-4779-ac71-c43fa0839fe9&quot;,&quot;title&quot;:&quot;exec script with incorrect passphrase&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 500&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh with remote key exec script with incorrect passphrase should return 500&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/exec&#x27;)\n\t\n\topt.body = {\n\t\tscript:  \&quot;ls -l\&quot;,\n\t\thost: SSH_HOST,\n\t\tport: SSH_HOST_PORT,\n\t\tusername: SSH_HOST_USERNAME,\n\t\tpassphrase: &#x27;blablabla&#x27;\n\t}\n    \n\texecRequestExpectError(opt, null, 500)\n\t.then( res =&gt; {\n\t\tcheckSshError(res, &#x27;SshError&#x27;, false, &#x27;client-authentication&#x27;)\n\t\tdone()\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e4b923a3-e44d-4f5a-84b1-9c6755fdf91a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e4b923a3-e44d-4f5a-84b1-9c6755fdf91a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:25000},{&quot;uuid&quot;:&quot;21c08930-e851-42b6-b984-0be6c9391346&quot;,&quot;title&quot;:&quot;exec script&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh with remote key exec script should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:621,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/exec&#x27;)\n\t\n\topt.body = {\n\t\tscript:  \&quot;echo $USER\&quot;,\n\t\thost: SSH_HOST,\n\t\tport: SSH_HOST_PORT,\n\t\tusername: SSH_HOST_USERNAME,\n\t\tpassphrase: SSH_HOST_PASSPHRASE\n\t}\n\t    \n    request( opt )\n\t.then( (res) =&gt; {\t\n\t\n\t\tassert.strictEqual(res.statusCode, 200, &#x27;status is not 200&#x27;);\n\t\tassert.strictEqual(res.body.stdout.trim(), SSH_HOST_USERNAME, &#x27;stdout != &#x27;+SSH_HOST_USERNAME);\n\t\tassert.strictEqual(res.body.stderr, &#x27;&#x27;, &#x27;stderr is not empty&#x27;);\n\t\tassert.strictEqual(res.body.exitCode, 0, &#x27;exitCode != 0&#x27;);\n\t\tdone();\t\t\t\t\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;5b6e5bda-158c-4bc6-9d1e-f2f948949870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5b6e5bda-158c-4bc6-9d1e-f2f948949870&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:621,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a50e455c-3b7d-422d-85e9-5abcd5d42fa7&quot;,&quot;title&quot;:&quot;exec script with stderr and exitCode=1&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh with remote key exec script with stderr and exitCode=1 should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let opt = getHttpOptions(&#x27;POST&#x27;, &#x27;/_plugin/ssh/exec&#x27;)\n\t\n\topt.body = {\n\t\tscript:  \&quot;cd /blablabla\&quot;,\n\t\thost: SSH_HOST,\n\t\tport: SSH_HOST_PORT,\n\t\tusername: SSH_HOST_USERNAME,\n\t\tpassphrase: SSH_HOST_PASSPHRASE\n\t}\n    \n    request( opt )\n\t.then( (res) =&gt; {\t\n\t\n\t\tassert.strictEqual(res.statusCode, 200, &#x27;status is not 200&#x27;);\n\t\tassert.strictEqual(res.body.stderr.trim() !== &#x27;&#x27;, true, &#x27;stderr is empty&#x27;);\n\t\tassert.strictEqual(res.body.exitCode, 1, &#x27;exitCode != 0&#x27;);\n\t\tdone();\t\t\t\t\n\t})\n\t.catch( err =&gt; {\n\t\tdone(err)\n\t})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fc313024-4435-4f24-9b22-8ca2638f2312&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fc313024-4435-4f24-9b22-8ca2638f2312&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:54,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;50778d24-c02b-44da-892f-8a38ac8dcfa6&quot;,&quot;title&quot;:&quot;/_plugin/ssh/download&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;73d620ec-d65b-407a-9d95-7fa0d0c488c7&quot;,&quot;title&quot;:&quot;download with password&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 200&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh/download download with password should return 200&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:760,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let params = &#x27;path=/tmp/upload.txt&amp;host=&#x27;+SSH_HOST+&#x27;&amp;username=&#x27;+SSH_HOST_USERNAME+&#x27;&amp;password=&#x27;+SSH_HOST_PASSWORD+&#x27;&amp;port=&#x27;+SSH_HOST_PORT\nlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/ssh/download?&#x27;+params)\n\nrequest( opt )\n.then( (res) =&gt; {\t\n\tassert.strictEqual(res.statusCode, 200, &#x27;status is not 200&#x27;);\n\tassert.strictEqual(res.headers[&#x27;content-disposition&#x27;], &#x27;attachment; filename=\&quot;upload.txt\&quot;&#x27;, &#x27;Content-Disposition is not attachment&#x27;);\n\tdone();\t\t\t\t\n})\n.catch( err =&gt; {\n\tdone(err)\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;ee6908a5-0ed6-4fde-bc2e-031846adc323&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ee6908a5-0ed6-4fde-bc2e-031846adc323&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:760,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;ff638fe7-6b46-4b0f-9ae2-ef47ebf1d604&quot;,&quot;title&quot;:&quot;download not existing file&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 400&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh/download download not existing file should return 400&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:643,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let params = &#x27;path=/tmp/blablablaff.txt&amp;host=&#x27;+SSH_HOST+&#x27;&amp;username=&#x27;+SSH_HOST_USERNAME+&#x27;&amp;password=&#x27;+SSH_HOST_PASSWORD+&#x27;&amp;port=&#x27;+SSH_HOST_PORT\nlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/ssh/download?&#x27;+params)\n\nexecRequestExpectError(opt, done, 400)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2da203b1-c6ae-4ecf-ae3f-8bd7ce764d2c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2da203b1-c6ae-4ecf-ae3f-8bd7ce764d2c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:643,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;70689d85-233f-438d-8bfc-318a900914a6&quot;,&quot;title&quot;:&quot;download directory&quot;,&quot;fullFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;file&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\50-plugin-ssh.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return 500&quot;,&quot;fullTitle&quot;:&quot;/_plugin/ssh/download download directory should return 500&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:748,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let params = &#x27;path=/tmp&amp;host=&#x27;+SSH_HOST+&#x27;&amp;username=&#x27;+SSH_HOST_USERNAME+&#x27;&amp;password=&#x27;+SSH_HOST_PASSWORD+&#x27;&amp;port=&#x27;+SSH_HOST_PORT\nlet opt = getHttpOptions(&#x27;GET&#x27;, &#x27;/_plugin/ssh/download?&#x27;+params)\n\nexecRequestExpectError(opt, done, 500)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7202e654-59b4-4645-8878-62de4e31e924&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7202e654-59b4-4645-8878-62de4e31e924&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:748,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000},&quot;copyrightYear&quot;:2020}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;D:\\projets\\mr-agent\\test/worker/mocha-report&quot;,&quot;reportTitle&quot;:&quot;bin&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\mocha-report\\assets&quot;,&quot;jsonFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\mocha-report\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;D:\\projets\\mr-agent\\test\\worker\\mocha-report\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>